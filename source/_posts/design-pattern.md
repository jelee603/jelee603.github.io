---
layout: post
title: 'Javascript 디자인패턴 이야기'
date: 2019-09-11
categories:
- JavaScript
comments: false
background: '/img/bg-post-08.jpg'
---

#### 클래스란? (클래스/상속 디자인 패턴)

클래스화란 데이터와 작동을 함께 잘 감싸서 캡슐화하는 것이 올바른 설계이다.
데이터에 적용 가능한 작동들을 메서드로 설계해야한다.
클래스에서는 어떤 작동이 담긴 메서드의 이름을 부모와 자식 클래스 모두 똑같이 공유하여 자식 클래스가 부모 클래스를 오바라이드하라고 권장한다.
그러나 자바스크립트에서는 이렇게 하면 불안정한 결과를 불러온다.

나는 대부분 절차적 프로그래밍을 해왔다는 걸 알게 되었다. 상위 추상화 없이 단순히 다른 함수를 호출해서 사용하는 방법만 사용해왔고,
클래스의 경우는 라이브러리를 통해서만 사용했었다. 그래서 편리함은 알지만, 다뤄보지 않은 영역이라 이번 기회에 다시 정리하고자 한다.

클래스는 복사 과정을 거쳐 객체 형태로 인스턴스화 한다.
인스턴스는 생성자가 해주는데 이 생성자는 미리 정보에 대한 변수를 초기화해준다.
항상 new 키워드를 앞에 붙여 생성자를 호출한다.

```js
class Button {}
var btn1 = new Button();
```

오버라이드하기 전의 원본 메서드와 오버라이드 메서드가 다를 수도 있는데 이를 다형성(오버라이드)이라 한다.
inherits/super 라는 키워드로 사용하며, 부모/조상 중 어떤 메서드를 호출할지 결정하는 것도 다형성의 기법이다.

자바스크립트엔 클래스란 개념 자체가 없고 오직 객체만 있다. 그래서 위와 같은 동작들은 자동으로 일어나지 않는다.
인스턴스화 해도 자동으로 복사가 되지않기 때문에 믹스인으로 클래스 복사기능을 흉내내었다.
이런 기능을 여러 라이브러리에서는 `extends()` 라 하고, 프로퍼티를 복사를 할 수 있게 제공된다.
믹스인 과정을 초콜릿 조각을 본인이 원하는 쿠키 반죽에 섞어 넣는 것에 비유한다. (이 말이 가장 기억에 남을거 같다)

이렇게 일일히 복사(믹스인) 하더라도 다른 클래스 지향처럼 100%(인스턴스) 복사는 어렵다.

#### 프로토타입이란? (프로토타입 디자인 패턴)

객체를 다른 객체에 연결한다. 수평적인 상태에서 위임이 되는 연결이다.
오버라이드 하기 딱 좋은 메서드 명칭보다는 각 객체의 작동방식을 설명하는 서술적인 명칭이 필요하다.
모든 레퍼런스가 확실히 존재한다면 양방향 위임은 가능하긴 하지만 무한 루프에 빠질 수 있다.

```js
var btn1 = Object.create(Button);
btn1.setup();
```

어떤 함수가 call(), apply(), bind() 메서드에 접근할 수 있는 건 함수 자신도 객체고 함수 객체 역시 `Function.prototype`에
[[Prototype]]이 연결되어 위임 가능한 메서드가 있어 가능한 것이다.
[infoscis][infoscis]님 블로그에 예제가 잘 나와있다.

```js
// ES6 [[Prototype]] 에 저장된 값을 변경한다.
Object.setPrototyupeOf();
```

[infoscis]: https://infoscis.github.io/2018/01/25/ecmascript-6-expanded-object-functionality/

#### Reference

- YOU DON'T KNOW JS - this 와 객체 프로토타입, 비동기와 성능
